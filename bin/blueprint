#!/usr/bin/env sh
set -eu

# RÃ©sout SCRIPT_DIR pour charger les libs
SCRIPT_DIR="$(CDPATH= cd -- "$(dirname -- "$0")/.." && pwd)"
LIB_DIR="$SCRIPT_DIR/lib"
CMD_DIR="$SCRIPT_DIR/commands"

# Charge les libs (ordre: constants -> ui -> le reste)
. "$LIB_DIR/constants.sh"
. "$LIB_DIR/ui.sh"
. "$LIB_DIR/fs.sh"
. "$LIB_DIR/docker.sh"
. "$LIB_DIR/fragments.sh"
. "$LIB_DIR/vite.sh"
. "$LIB_DIR/backend.sh"

main() {
  [ $# -lt 1 ] && usage && exit 0
  sub="$1"; shift || true
  case "$sub" in
    app) . "$CMD_DIR/app.sh"; app_main "$@";;
    -h|--help|help) usage ;;
    -v|--version) say "$VERSION" ;;
    *) usage ;;
  esac
}

main "$@"
